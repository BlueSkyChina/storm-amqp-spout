<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_23) on Wed Dec 21 17:07:29 PST 2011 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
AMQPSpout (storm-amqp-spout 0.1.1 API)
</TITLE>

<META NAME="date" CONTENT="2011-12-21">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AMQPSpout (storm-amqp-spout 0.1.1 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AMQPSpout.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?com/rapportive/storm/spout/AMQPSpout.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AMQPSpout.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.rapportive.storm.spout</FONT>
<BR>
Class AMQPSpout</H2>
<PRE>
<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>com.rapportive.storm.spout.AMQPSpout</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A>, <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IComponent.html?is-external=true" title="class or interface in backtype.storm.topology">IComponent</A>, <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IRichSpout.html?is-external=true" title="class or interface in backtype.storm.topology">IRichSpout</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>AMQPSpout</B><DT>extends <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A><DT>implements <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IRichSpout.html?is-external=true" title="class or interface in backtype.storm.topology">IRichSpout</A></DL>
</PRE>

<P>
Spout to feed messages into Storm from an AMQP queue.  Each message routed
 to the queue will be emitted as a Storm tuple.  The message will be acked or
 rejected once the topology has respectively fully processed or failed the
 corresponding tuple.

 <p><strong>N.B.</strong> if you need to guarantee all messages are reliably
 processed, you should have AMQPSpout consume from a queue that is
 <em>not</em> set as 'exclusive' or 'auto-delete': otherwise if the spout
 task crashes or is restarted, the queue will be deleted and any messages in
 it lost, as will any messages published while the task remains down.  See
 <A HREF="../../../../com/rapportive/storm/amqp/SharedQueueWithBinding.html" title="class in com.rapportive.storm.amqp"><CODE>SharedQueueWithBinding</CODE></A> to declare a shared
 queue that allows for guaranteed processing.  (For prototyping, an
 <A HREF="../../../../com/rapportive/storm/amqp/ExclusiveQueueWithBinding.html" title="class in com.rapportive.storm.amqp"><CODE>ExclusiveQueueWithBinding</CODE></A> may be
 simpler to manage.)</p>

 <p><strong>N.B.</strong> this does not currently handle malformed messages
 (which cannot be deserialised by the provided <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout"><CODE>Scheme</CODE></A>) very well:
 the spout worker will crash if it fails to serialise a message.</p>

 <p>This consumes messages from AMQP asynchronously, so it may receive
 messages before Storm requests them as tuples; therefore it buffers messages
 in an internal queue.  To avoid this buffer growing large and consuming too
 much RAM, set <A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#CONFIG_PREFETCH_COUNT"><CODE>CONFIG_PREFETCH_COUNT</CODE></A>.</p>

 <p>This spout can be distributed among multiple workers, depending on the
 queue declaration: see <A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html#isParallelConsumable()"><CODE>QueueDeclaration.isParallelConsumable()</CODE></A>.</p>
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Sam Stokes (sam@rapportive.com)</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html" title="interface in com.rapportive.storm.amqp"><CODE>QueueDeclaration</CODE></A>, 
<A HREF="../../../../com/rapportive/storm/amqp/SharedQueueWithBinding.html" title="class in com.rapportive.storm.amqp"><CODE>SharedQueueWithBinding</CODE></A>, 
<A HREF="../../../../com/rapportive/storm/amqp/ExclusiveQueueWithBinding.html" title="class in com.rapportive.storm.amqp"><CODE>ExclusiveQueueWithBinding</CODE></A>, 
<A HREF="../../../../serialized-form.html#com.rapportive.storm.spout.AMQPSpout">Serialized Form</A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#CONFIG_PREFETCH_COUNT">CONFIG_PREFETCH_COUNT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Storm config key to set the AMQP basic.qos prefetch-count parameter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#WAIT_AFTER_SHUTDOWN_SIGNAL">WAIT_AFTER_SHUTDOWN_SIGNAL</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time in milliseconds to wait after losing connection to the AMQP broker
 before attempting to reconnect.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#WAIT_FOR_NEXT_MESSAGE">WAIT_FOR_NEXT_MESSAGE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time in milliseconds to wait for a message from the queue if there is
 no message ready when the topology requests a tuple (via
 <A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#nextTuple()"><CODE>nextTuple()</CODE></A>).</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#AMQPSpout(java.lang.String, int, java.lang.String, java.lang.String, java.lang.String, com.rapportive.storm.amqp.QueueDeclaration, backtype.storm.spout.Scheme)">AMQPSpout</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;host,
          int&nbsp;port,
          <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;username,
          <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;password,
          <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;vhost,
          <A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html" title="interface in com.rapportive.storm.amqp">QueueDeclaration</A>&nbsp;queueDeclaration,
          <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout">Scheme</A>&nbsp;scheme)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a new AMQP spout.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#ack(java.lang.Object)">ack</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;msgId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acks the message with the AMQP broker.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#close()">close</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cancels the queue subscription, and disconnects from the AMQP broker.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#declareOutputFields(backtype.storm.topology.OutputFieldsDeclarer)">declareOutputFields</A></B>(<A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/OutputFieldsDeclarer.html?is-external=true" title="class or interface in backtype.storm.topology">OutputFieldsDeclarer</A>&nbsp;declarer)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Declares the output fields of this spout according to the provided
 <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout"><CODE>Scheme</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#fail(java.lang.Object)">fail</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;msgId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tells the AMQP broker to drop (Basic.Reject) the message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#isDistributed()">isDistributed</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This spout can be distributed among multiple workers if the
 <A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html" title="interface in com.rapportive.storm.amqp"><CODE>QueueDeclaration</CODE></A> supports it.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#nextTuple()">nextTuple</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emits the next message from the queue as a tuple.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#open(java.util.Map, backtype.storm.task.TopologyContext, backtype.storm.spout.SpoutOutputCollector)">open</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</A>&nbsp;config,
     <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/task/TopologyContext.html?is-external=true" title="class or interface in backtype.storm.task">TopologyContext</A>&nbsp;context,
     <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/SpoutOutputCollector.html?is-external=true" title="class or interface in backtype.storm.spout">SpoutOutputCollector</A>&nbsp;collector)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connects to the AMQP broker, declares the queue and subscribes to
 incoming messages.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CONFIG_PREFETCH_COUNT"><!-- --></A><H3>
CONFIG_PREFETCH_COUNT</H3>
<PRE>
public static final <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>CONFIG_PREFETCH_COUNT</B></PRE>
<DL>
<DD>Storm config key to set the AMQP basic.qos prefetch-count parameter.
 Defaults to 100.

 <p>This caps the number of messages outstanding (i.e. unacked) at a time
 that will be sent to each spout worker.  Increasing this will improve
 throughput if the network roundtrip time to the AMQP broker is
 significant compared to the time for the topology to process each
 message; this will also increase the RAM requirements as the internal
 message buffer grows.</p>

 <p>AMQP allows a prefetch-count of zero, indicating unlimited delivery,
 but that is not allowed here to avoid unbounded buffer growth.</p>
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.rapportive.storm.spout.AMQPSpout.CONFIG_PREFETCH_COUNT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="WAIT_FOR_NEXT_MESSAGE"><!-- --></A><H3>
WAIT_FOR_NEXT_MESSAGE</H3>
<PRE>
public static final long <B>WAIT_FOR_NEXT_MESSAGE</B></PRE>
<DL>
<DD>Time in milliseconds to wait for a message from the queue if there is
 no message ready when the topology requests a tuple (via
 <A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#nextTuple()"><CODE>nextTuple()</CODE></A>).
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.rapportive.storm.spout.AMQPSpout.WAIT_FOR_NEXT_MESSAGE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="WAIT_AFTER_SHUTDOWN_SIGNAL"><!-- --></A><H3>
WAIT_AFTER_SHUTDOWN_SIGNAL</H3>
<PRE>
public static final long <B>WAIT_AFTER_SHUTDOWN_SIGNAL</B></PRE>
<DL>
<DD>Time in milliseconds to wait after losing connection to the AMQP broker
 before attempting to reconnect.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.rapportive.storm.spout.AMQPSpout.WAIT_AFTER_SHUTDOWN_SIGNAL">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AMQPSpout(java.lang.String, int, java.lang.String, java.lang.String, java.lang.String, com.rapportive.storm.amqp.QueueDeclaration, backtype.storm.spout.Scheme)"><!-- --></A><H3>
AMQPSpout</H3>
<PRE>
public <B>AMQPSpout</B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;host,
                 int&nbsp;port,
                 <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;username,
                 <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;password,
                 <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;vhost,
                 <A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html" title="interface in com.rapportive.storm.amqp">QueueDeclaration</A>&nbsp;queueDeclaration,
                 <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout">Scheme</A>&nbsp;scheme)</PRE>
<DL>
<DD>Create a new AMQP spout.  When
 <A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#open(java.util.Map, backtype.storm.task.TopologyContext, backtype.storm.spout.SpoutOutputCollector)"><CODE>open(Map, TopologyContext, SpoutOutputCollector)</CODE></A> is called, it
 will declare a queue according to the specified
 <tt>queueDeclaration</tt>, subscribe to the queue, and start consuming
 messages.  It will use the provided <tt>scheme</tt> to deserialise each
 AMQP message into a Storm tuple.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>host</CODE> - hostname of the AMQP broker node<DD><CODE>port</CODE> - port number of the AMQP broker node<DD><CODE>username</CODE> - username to log into to the broker<DD><CODE>password</CODE> - password to authenticate to the broker<DD><CODE>vhost</CODE> - vhost on the broker<DD><CODE>queueDeclaration</CODE> - declaration of the queue / exchange bindings<DD><CODE>scheme</CODE> - <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout"><CODE>Scheme</CODE></A> used to deserialise
          each AMQP message into a Storm tuple</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="ack(java.lang.Object)"><!-- --></A><H3>
ack</H3>
<PRE>
public void <B>ack</B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;msgId)</PRE>
<DL>
<DD>Acks the message with the AMQP broker.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true#ack(java.lang.Object)" title="class or interface in backtype.storm.spout">ack</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="close()"><!-- --></A><H3>
close</H3>
<PRE>
public void <B>close</B>()</PRE>
<DL>
<DD>Cancels the queue subscription, and disconnects from the AMQP broker.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true#close()" title="class or interface in backtype.storm.spout">close</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="fail(java.lang.Object)"><!-- --></A><H3>
fail</H3>
<PRE>
public void <B>fail</B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;msgId)</PRE>
<DL>
<DD>Tells the AMQP broker to drop (Basic.Reject) the message.

 <p><strong>N.B.</strong> this does <em>not</em> requeue the message:
 failed messages will simply be dropped.  This is to prevent infinite
 redelivery in the event of non-transient failures (e.g. malformed
 messages).  However it means that messages will <em>not</em> be retried
 in the event of transient failures.</p>

 <p><strong>TODO</strong> make this configurable.</p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true#fail(java.lang.Object)" title="class or interface in backtype.storm.spout">fail</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="nextTuple()"><!-- --></A><H3>
nextTuple</H3>
<PRE>
public void <B>nextTuple</B>()</PRE>
<DL>
<DD>Emits the next message from the queue as a tuple.

 <p>If no message is ready to emit, this will wait a short time
 (<A HREF="../../../../com/rapportive/storm/spout/AMQPSpout.html#WAIT_FOR_NEXT_MESSAGE"><CODE>WAIT_FOR_NEXT_MESSAGE</CODE></A>) for one to arrive on the queue,
 to avoid a tight loop in the spout worker.</p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true#nextTuple()" title="class or interface in backtype.storm.spout">nextTuple</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="open(java.util.Map, backtype.storm.task.TopologyContext, backtype.storm.spout.SpoutOutputCollector)"><!-- --></A><H3>
open</H3>
<PRE>
public void <B>open</B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</A>&nbsp;config,
                 <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/task/TopologyContext.html?is-external=true" title="class or interface in backtype.storm.task">TopologyContext</A>&nbsp;context,
                 <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/SpoutOutputCollector.html?is-external=true" title="class or interface in backtype.storm.spout">SpoutOutputCollector</A>&nbsp;collector)</PRE>
<DL>
<DD>Connects to the AMQP broker, declares the queue and subscribes to
 incoming messages.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true#open(java.util.Map, backtype.storm.task.TopologyContext, backtype.storm.spout.SpoutOutputCollector)" title="class or interface in backtype.storm.spout">open</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/ISpout.html?is-external=true" title="class or interface in backtype.storm.spout">ISpout</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="declareOutputFields(backtype.storm.topology.OutputFieldsDeclarer)"><!-- --></A><H3>
declareOutputFields</H3>
<PRE>
public void <B>declareOutputFields</B>(<A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/OutputFieldsDeclarer.html?is-external=true" title="class or interface in backtype.storm.topology">OutputFieldsDeclarer</A>&nbsp;declarer)</PRE>
<DL>
<DD>Declares the output fields of this spout according to the provided
 <A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/spout/Scheme.html?is-external=true" title="class or interface in backtype.storm.spout"><CODE>Scheme</CODE></A>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IComponent.html?is-external=true#declareOutputFields(backtype.storm.topology.OutputFieldsDeclarer)" title="class or interface in backtype.storm.topology">declareOutputFields</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IComponent.html?is-external=true" title="class or interface in backtype.storm.topology">IComponent</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="isDistributed()"><!-- --></A><H3>
isDistributed</H3>
<PRE>
public boolean <B>isDistributed</B>()</PRE>
<DL>
<DD>This spout can be distributed among multiple workers if the
 <A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html" title="interface in com.rapportive.storm.amqp"><CODE>QueueDeclaration</CODE></A> supports it.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IRichSpout.html?is-external=true#isDistributed()" title="class or interface in backtype.storm.topology">isDistributed</A></CODE> in interface <CODE><A HREF="http://nathanmarz.github.com/storm/doc/backtype/storm/topology/IRichSpout.html?is-external=true" title="class or interface in backtype.storm.topology">IRichSpout</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>See Also:</B><DD><A HREF="../../../../com/rapportive/storm/amqp/QueueDeclaration.html#isParallelConsumable()"><CODE>QueueDeclaration.isParallelConsumable()</CODE></A></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AMQPSpout.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?com/rapportive/storm/spout/AMQPSpout.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AMQPSpout.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2011. All Rights Reserved.
</BODY>
</HTML>
